<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ELITECORE ULTIMATE GOD AI</title>

<!-- TAILWIND -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- MARKDOWN -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>

<!-- FONTS -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@300;600;900&display=swap" rel="stylesheet">

<style>

/* ==========================
   ELITECORE CYBERPUNK CORE UI
========================== */

body {
  margin:0;
  background:black;
  color:#00f5ff;
  font-family:Orbitron, monospace;
  overflow:hidden;
}

/* Matrix Canvas */
#matrix {
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  z-index:-1;
}

/* Neon Panels */
.cyber-panel {
  background:rgba(0,0,0,0.6);
  border:1px solid #00f5ff;
  box-shadow:0 0 15px #00f5ff;
  backdrop-filter:blur(10px);
  padding:10px;
  border-radius:15px;
}

/* Neon Text */
.neon {
  text-shadow:0 0 5px #00f5ff,0 0 15px #00aaff,0 0 30px #00aaff;
}

/* HUD */
#hud {
  position:fixed;
  top:5px;
  right:5px;
  background:black;
  padding:8px;
  font-size:12px;
  border:1px solid #00f5ff;
  z-index:9999;
}

/* Chat Area */
#chat-box {
  height:70vh;
  overflow-y:auto;
  padding:10px;
}

/* Input */
#input {
  width:100%;
  background:black;
  border:1px solid #00f5ff;
  color:#00f5ff;
  padding:12px;
  border-radius:12px;
  resize:none;
}

button {
  background:black;
  border:1px solid #ff00ff;
  color:#ff00ff;
  padding:10px 15px;
  border-radius:10px;
  box-shadow:0 0 10px #ff00ff;
}

button:hover {
  background:#ff00ff;
  color:black;
}

</style>
</head>

<body>

<!-- MATRIX BACKGROUND -->
<canvas id="matrix"></canvas>

<!-- SYSTEM HUD -->
<div id="hud">BOOTING ELITECORE...</div>

<!-- MAIN UI -->
<div class="max-w-4xl mx-auto mt-4 cyber-panel">
  <h1 class="text-2xl font-bold neon">ELITECORE ULTIMATE GOD AI</h1>
  <p class="text-xs text-green-400">Neural Core Online | Cyberpunk Mode Enabled</p>

  <div id="chat-box" class="cyber-panel mt-3"></div>

  <textarea id="input" placeholder="Message EliteCore..."></textarea>
  <button onclick="sendMessage()">SEND</button>
</div>

<script>
/* ==========================
   PART 1 ENGINE CORE
========================== */

/* MATRIX BACKGROUND ENGINE */
const canvas = document.getElementById("matrix");
const ctx = canvas.getContext("2d");

function resizeMatrix() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resizeMatrix();
window.onresize = resizeMatrix;

const chars = "01ELITECOREAI";
const fontSize = 14;
let drops = Array(Math.floor(innerWidth / fontSize)).fill(0);

setInterval(() => {
  ctx.fillStyle = "rgba(0,0,0,0.05)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "#00f5ff";
  ctx.font = fontSize + "px monospace";

  for (let i = 0; i < drops.length; i++) {
    const text = chars[Math.floor(Math.random() * chars.length)];
    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
    drops[i]++;
    if (drops[i] * fontSize > canvas.height) drops[i] = 0;
  }
}, 50);


/* ==========================
   VECTOR MEMORY SYSTEM
========================== */
class EliteMemory {
  constructor() {
    this.mem = JSON.parse(localStorage.getItem("elite_memory") || "[]");
  }
  save(text) {
    this.mem.push({ t: Date.now(), text });
    this.mem = this.mem.slice(-200);
    localStorage.setItem("elite_memory", JSON.stringify(this.mem));
  }
  recall() {
    return this.mem.map(m => m.text).join("\n");
  }
}
const MEMORY = new EliteMemory();


/* ==========================
   SYSTEM HUD (FPS + RAM)
========================== */
const hud = document.getElementById("hud");
let fps = 0;

function fpsLoop() {
  fps++;
  requestAnimationFrame(fpsLoop);
}
fpsLoop();

setInterval(() => {
  const ram = performance.memory?.usedJSHeapSize / 1048576 || 0;
  hud.innerText = `ELITECORE ONLINE | FPS:${fps} | RAM:${ram.toFixed(1)}MB`;
  fps = 0;
}, 1000);


/* ==========================
   CHAT CORE ENGINE (LOCAL DEMO)
   PART 2 WILL ADD REAL AI API
========================== */
const chatBox = document.getElementById("chat-box");

function appendMessage(role, text) {
  const div = document.createElement("div");
  div.className = "cyber-panel mt-2";
  div.innerHTML = `<b>${role}:</b> ${text}`;
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
}

function sendMessage() {
  const input = document.getElementById("input");
  const text = input.value.trim();
  if (!text) return;

  appendMessage("YOU", text);
  MEMORY.save(text);
  input.value = "";

  // TEMP AI RESPONSE (PART 2 will replace with GPT API)
  setTimeout(() => {
    const memory = MEMORY.recall();
    appendMessage("ELITECORE", "Memory Stored. Neural Core Growing...");
  }, 500);
}


/* ==========================
   JARVIS VOICE CORE (PARTIAL)
========================== */
function eliteSpeak(text) {
  const s = new SpeechSynthesisUtterance(text);
  s.rate = 1;
  s.pitch = 1;
  speechSynthesis.speak(s);
}

eliteSpeak("EliteCore God Mode Activated");

</script>
<!-- ===============================
     ELITECORE SIDEBAR UI
================================ -->
<div id="sidebar" style="
position:fixed;left:0;top:0;width:260px;height:100%;
background:black;border-right:1px solid #00f5ff;
padding:10px;overflow-y:auto;z-index:9998;">
  <h2 class="neon">CHATS</h2>
  <button onclick="newChat()" style="width:100%;margin-bottom:10px;">+ NEW CHAT</button>
  <div id="chatList"></div>
  <hr style="border:1px solid #00f5ff;margin:10px 0;">
  <button onclick="openSettings()">‚öô SETTINGS</button>
</div>

<!-- SHIFT MAIN UI -->
<style>
body { padding-left:260px; }
</style>

<!-- ===============================
     SETTINGS MODAL
================================ -->
<div id="settingsModal" style="
position:fixed;inset:0;background:rgba(0,0,0,0.8);
display:none;align-items:center;justify-content:center;z-index:9999;">
  <div class="cyber-panel" style="width:400px;">
    <h2 class="neon">ELITECORE SETTINGS</h2>
    <label>API KEY</label>
    <input id="apiKeyInput" type="password" style="width:100%;background:black;border:1px solid #00f5ff;color:#00f5ff;padding:6px;">
    <label>MODEL</label>
    <input id="modelInput" value="deepseek/deepseek-r1:free" style="width:100%;background:black;border:1px solid #00f5ff;color:#00f5ff;padding:6px;">
    <button onclick="saveSettings()">SAVE</button>
    <button onclick="closeSettings()">CLOSE</button>
  </div>
</div>

<script>
/* ===============================
   ELITECORE GLOBAL STATE
================================ */
const STATE = {
  chats: [],
  currentChat: null,
  apiKey: localStorage.getItem("elite_api") || "",
  model: localStorage.getItem("elite_model") || "deepseek/deepseek-r1:free",
};

/* ===============================
   CHAT STORAGE SYSTEM
================================ */
function saveChats() {
  localStorage.setItem("elite_chats", JSON.stringify(STATE.chats));
}
function loadChats() {
  STATE.chats = JSON.parse(localStorage.getItem("elite_chats") || "[]");
}
loadChats();

/* ===============================
   CHAT UI RENDER
================================ */
function renderChatList() {
  const list = document.getElementById("chatList");
  list.innerHTML = "";
  STATE.chats.forEach((c,i)=>{
    const d = document.createElement("div");
    d.className="cyber-panel mt-1 cursor-pointer";
    d.innerText = c.title;
    d.onclick = ()=>loadChat(i);
    list.appendChild(d);
  });
}

function newChat() {
  const chat = {title:"New Chat", messages:[]};
  STATE.chats.unshift(chat);
  STATE.currentChat = chat;
  saveChats();
  renderChatList();
  chatBox.innerHTML="";
}

function loadChat(i) {
  STATE.currentChat = STATE.chats[i];
  chatBox.innerHTML="";
  STATE.currentChat.messages.forEach(m=>appendMessage(m.role,m.content));
}

/* ===============================
   SETTINGS MODAL
================================ */
function openSettings(){
  document.getElementById("settingsModal").style.display="flex";
  document.getElementById("apiKeyInput").value = STATE.apiKey;
  document.getElementById("modelInput").value = STATE.model;
}
function closeSettings(){
  document.getElementById("settingsModal").style.display="none";
}
function saveSettings(){
  STATE.apiKey = document.getElementById("apiKeyInput").value.trim();
  STATE.model = document.getElementById("modelInput").value.trim();
  localStorage.setItem("elite_api", STATE.apiKey);
  localStorage.setItem("elite_model", STATE.model);
  alert("SAVED");
  closeSettings();
}

/* ===============================
   STREAMING AI ENGINE (REAL GPT)
================================ */
async function sendMessage() {
  const input = document.getElementById("input");
  const text = input.value.trim();
  if (!text) return;
  if (!STATE.apiKey) return alert("SET API KEY IN SETTINGS");

  if (!STATE.currentChat) newChat();

  appendMessage("YOU", text);
  STATE.currentChat.messages.push({role:"user",content:text});
  MEMORY.save(text);
  input.value="";

  const aiDiv = document.createElement("div");
  aiDiv.className="cyber-panel mt-2";
  aiDiv.innerHTML="<b>ELITECORE:</b> <span id='aiStream'></span>";
  chatBox.appendChild(aiDiv);
  const aiStream = aiDiv.querySelector("#aiStream");

  let aiText = "";

  const res = await fetch("https://openrouter.ai/api/v1/chat/completions", {
    method:"POST",
    headers:{
      "Authorization":"Bearer "+STATE.apiKey,
      "Content-Type":"application/json",
      "HTTP-Referer":location.href,
      "X-Title":"EliteCore"
    },
    body:JSON.stringify({
      model:STATE.model,
      messages:[
        {role:"system",content:"You are EliteCore God AI."},
        ...STATE.currentChat.messages
      ],
      stream:true
    })
  });

  const reader = res.body.getReader();
  const decoder = new TextDecoder();

  while(true){
    const {done,value} = await reader.read();
    if(done) break;
    const chunk = decoder.decode(value);
    const lines = chunk.split("\n");
    for(const l of lines){
      if(l.startsWith("data: ")){
        const d = l.slice(6);
        if(d==="[DONE]") break;
        try{
          const j = JSON.parse(d);
          const c = j.choices[0].delta.content || "";
          aiText += c;
          aiStream.innerText = aiText;
          chatBox.scrollTop = chatBox.scrollHeight;
        }catch{}
      }
    }
  }

  STATE.currentChat.messages.push({role:"assistant",content:aiText});
  saveChats();
  eliteSpeak(aiText.slice(0,200));
}

/* INIT CHAT LIST */
renderChatList();
</script>
<!-- =========================================================
 ELITECORE PART 3 ‚Äì ADVANCED MEMORY + TERMINAL CORE
========================================================= -->

<script>
/* ============================
   ELITECORE TERMINAL ENGINE
============================ */
class EliteTerminal {
  constructor(){
    this.logs = [];
    this.el = document.getElementById("elite-terminal");
  }
  log(msg){
    const time = new Date().toLocaleTimeString();
    const entry = `[${time}] ${msg}`;
    this.logs.push(entry);
    if(this.el){
      this.el.innerHTML += entry + "<br>";
      this.el.scrollTop = this.el.scrollHeight;
    }
    console.log("EliteCore:", msg);
  }
}
const TERM = new EliteTerminal();
TERM.log("EliteCore Terminal Initialized");

/* ============================
   ELITECORE ADVANCED MEMORY (IndexedDB)
============================ */
let db;
function initDB(){
  const request = indexedDB.open("EliteCoreDB", 1);
  request.onupgradeneeded = e=>{
    db = e.target.result;
    db.createObjectStore("memory", { autoIncrement:true });
  };
  request.onsuccess = e=>{
    db = e.target.result;
    TERM.log("IndexedDB Memory Loaded");
  };
}
initDB();

function saveMemory(text){
  const tx = db.transaction("memory","readwrite");
  const store = tx.objectStore("memory");
  store.add({ text, time: Date.now() });
}

function loadMemory(callback){
  const tx = db.transaction("memory","readonly");
  const store = tx.objectStore("memory");
  const req = store.getAll();
  req.onsuccess = ()=> callback(req.result);
}

/* ============================
   ELITECORE AI SIMULATION ENGINE
============================ */
class EliteAI {
  constructor(){
    this.persona = "ELITECORE GOD AI";
    this.version = "ULTIMATE MONSTER MODE v0.3";
  }
  think(input){
    TERM.log("Thinking...");
    return "EliteCore Response: " + input.split("").reverse().join("");
  }
}
const AI = new EliteAI();

/* ============================
   CHAT SYSTEM CORE
============================ */
const chatBox = document.getElementById("chat-box");
function sendMessage(){
  const input = document.getElementById("chat-input");
  const text = input.value.trim();
  if(!text) return;

  chatBox.innerHTML += `<div class='user'>üë§ ${text}</div>`;
  saveMemory(text);

  const reply = AI.think(text);
  chatBox.innerHTML += `<div class='ai'>ü§ñ ${reply}</div>`;
  speak(reply);

  input.value = "";
}

/* ============================
   VOICE CORE
============================ */
function speak(text){
  const u = new SpeechSynthesisUtterance(text);
  u.rate = 1;
  u.pitch = 1;
  u.volume = 1;
  speechSynthesis.speak(u);
}

/* ============================
   SYSTEM MONITOR CORE
============================ */
let cpu = 0, ram = 0;
setInterval(()=>{
  cpu = Math.random()*100;
  ram = Math.random()*100;
  document.getElementById("sys-info").innerHTML =
    `CPU: ${cpu.toFixed(1)}% | RAM: ${ram.toFixed(1)}%`;
},1000);

/* ============================
   GOD MODE BOOT MESSAGE
============================ */
TERM.log("EliteCore ULTIMATE MONSTER MODE LOADED");
TERM.log("System Online. Awaiting Commands.");
</script>

<!-- UI TERMINAL PANEL -->
<div id="elite-terminal" style="background:black;color:#00ffea;padding:10px;height:200px;overflow:auto;font-family:monospace;border:1px solid cyan;"></div>

<!-- CHAT UI -->
<div id="chat-box" style="background:#020b12;color:#0ff;padding:10px;height:200px;overflow:auto;border:1px solid cyan;"></div>
<input id="chat-input" placeholder="Type to EliteCore..." style="width:80%;">
<button onclick="sendMessage()">SEND</button>

<!-- SYSTEM INFO HUD -->
<div id="sys-info" style="position:fixed;top:10px;right:10px;color:#0ff;font-family:monospace;"></div>
<!-- =========================================================
 ELITECORE PART 4 ‚Äì REAL AI STREAM ENGINE + CYBER MATRIX
========================================================= -->

<style>
/* MATRIX BACKGROUND */
#matrixCanvas {
  position: fixed;
  top: 0;
  left: 0;
  z-index: -1;
  background: black;
}

/* CHAT UI STYLE UPGRADE */
.user { color:#00ffaa; }
.ai { color:#ff00ff; }
</style>

<canvas id="matrixCanvas"></canvas>

<script>
/* ============================
   MATRIX CYBER BACKGROUND
============================ */
const canvas = document.getElementById("matrixCanvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const letters = "01ELITECOREGODMODE";
const fontSize = 14;
const columns = canvas.width / fontSize;
const drops = Array.from({length: columns}).fill(1);

function drawMatrix(){
  ctx.fillStyle = "rgba(0,0,0,0.05)";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle = "#00ffea";
  ctx.font = fontSize + "px monospace";

  for(let i=0;i<drops.length;i++){
    const text = letters[Math.floor(Math.random()*letters.length)];
    ctx.fillText(text, i*fontSize, drops[i]*fontSize);
    if(drops[i]*fontSize > canvas.height && Math.random() > 0.975){
      drops[i]=0;
    }
    drops[i]++;
  }
}
setInterval(drawMatrix, 35);

/* ============================
   REAL AI API CORE (OPENAI / OPENROUTER)
============================ */
const API_URL = "https://api.openai.com/v1/chat/completions"; 
// You can change to OpenRouter or local AI server

let API_KEY = "PASTE_YOUR_KEY_HERE"; // üî• YOU will add your own key

async function realAI(prompt){
  TERM.log("Connecting to AI API...");

  const response = await fetch(API_URL,{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "Authorization":"Bearer " + API_KEY
    },
    body: JSON.stringify({
      model: "gpt-4.1-mini", // change model if you want
      messages:[
        {role:"system", content:"You are EliteCore GOD AI."},
        {role:"user", content: prompt}
      ],
      temperature:0.7
    })
  });

  const data = await response.json();
  return data.choices[0].message.content;
}

/* ============================
   OVERRIDE SEND SYSTEM (REAL AI)
============================ */
async function sendMessage(){
  const input = document.getElementById("chat-input");
  const text = input.value.trim();
  if(!text) return;

  chatBox.innerHTML += `<div class='user'>üë§ ${text}</div>`;
  saveMemory(text);

  chatBox.innerHTML += `<div class='ai'>ü§ñ Thinking...</div>`;
  const reply = await realAI(text);

  chatBox.innerHTML += `<div class='ai'>ü§ñ ${reply}</div>`;
  speak(reply);

  TERM.log("AI Response Generated");
  input.value="";
}

/* ============================
   DEV ADMIN COMMAND SYSTEM
============================ */
function eliteCommand(cmd){
  TERM.log("CMD: " + cmd);

  if(cmd==="godmode"){
    document.body.style.filter = "hue-rotate(180deg)";
    TERM.log("GOD MODE VISUAL ENABLED");
  }
  if(cmd==="clear"){
    chatBox.innerHTML="";
    TERM.log("Chat Cleared");
  }
}

/* ENTER KEY TO SEND */
document.getElementById("chat-input").addEventListener("keydown",e=>{
  if(e.key==="Enter") sendMessage();
});
</script>
<!-- =========================================================
 ELITECORE PART 5 ‚Äì STREAMING CHAT + VECTOR MEMORY + PLUGINS
========================================================= -->

<script>
/* ============================
   STREAMING TYPEWRITER EFFECT
============================ */
async function typeStream(element, text, speed=15){
  element.innerHTML = "ü§ñ ";
  for(let i=0;i<text.length;i++){
    element.innerHTML += text[i];
    await new Promise(r=>setTimeout(r,speed));
  }
}

/* ============================
   VECTOR MEMORY (FAKE EMBEDDINGS ENGINE)
   (Real embeddings coming in Part 6)
============================ */
class VectorStore {
  constructor(){
    this.vectors = JSON.parse(localStorage.getItem("elite_vectors")||"[]");
  }
  add(text){
    const vector = text.split("").map(c=>c.charCodeAt(0)%10);
    this.vectors.push({text, vector});
    localStorage.setItem("elite_vectors", JSON.stringify(this.vectors));
  }
  search(query){
    const qv = query.split("").map(c=>c.charCodeAt(0)%10);
    let best = null, bestScore=999999;
    for(let v of this.vectors){
      let score = 0;
      for(let i=0;i<Math.min(v.vector.length,qv.length);i++){
        score += Math.abs(v.vector[i]-qv[i]);
      }
      if(score<bestScore){
        bestScore=score;
        best=v.text;
      }
    }
    return best;
  }
}
const VEC = new VectorStore();

/* ============================
   OVERRIDE REAL AI SEND (WITH MEMORY)
============================ */
async function sendMessage(){
  const input = document.getElementById("chat-input");
  const text = input.value.trim();
  if(!text) return;

  chatBox.innerHTML += `<div class='user'>üë§ ${text}</div>`;
  saveMemory(text);
  VEC.add(text);

  const memoryRecall = VEC.search(text) || "No memory";

  const aiDiv = document.createElement("div");
  aiDiv.className="ai";
  aiDiv.innerHTML="ü§ñ Thinking...";
  chatBox.appendChild(aiDiv);

  const reply = await realAI("Memory: "+memoryRecall+"\nUser: "+text);
  await typeStream(aiDiv, reply);

  speak(reply);
  TERM.log("AI Streaming Response Done");
  input.value="";
}

/* ============================
   PLUGIN SYSTEM CORE
============================ */
const Plugins = {};

function registerPlugin(name, plugin){
  Plugins[name] = plugin;
  TERM.log("Plugin Loaded: " + name);
}

function runPlugin(name, data){
  if(Plugins[name]) Plugins[name](data);
}

/* ============================
   SAMPLE BUILT-IN PLUGINS
============================ */
registerPlugin("time", ()=>{
  alert("Time: " + new Date().toLocaleTimeString());
});

registerPlugin("hackermode", ()=>{
  document.body.style.background="black";
  document.body.style.color="lime";
  TERM.log("HACKER MODE ACTIVATED");
});

/* ============================
   TERMINAL COMMAND EXTENSION
============================ */
function eliteCommand(cmd){
  TERM.log("CMD: " + cmd);

  if(cmd==="godmode"){
    document.body.style.filter = "hue-rotate(180deg)";
    TERM.log("GOD MODE VISUAL ENABLED");
  }
  if(cmd==="clear"){
    chatBox.innerHTML="";
    TERM.log("Chat Cleared");
  }
  if(cmd==="plugin time"){
    runPlugin("time");
  }
  if(cmd==="plugin hacker"){
    runPlugin("hackermode");
  }
}

/* ============================
   AUTO BOOT SEQUENCE
============================ */
setTimeout(()=>TERM.log("EliteCore Neural Engine Online"),1000);
setTimeout(()=>TERM.log("Vector Memory Loaded: "+VEC.vectors.length),2000);
setTimeout(()=>TERM.log("Plugin System Ready"),3000);
</script>
<!-- =========================================================
 ELITECORE PART 6 ‚Äì REAL EMBEDDINGS MEMORY + ADMIN DASHBOARD
========================================================= -->

<style>
/* ADMIN PANEL */
#adminPanel {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 220px;
  background: #050010;
  color: #0ff;
  font-family: monospace;
  border-top: 2px solid cyan;
  display: flex;
}

.admin-box {
  flex: 1;
  padding: 10px;
  overflow: auto;
  border-right: 1px solid cyan;
}

/* FILE MANAGER */
.file {
  padding: 4px;
  cursor: pointer;
  border-bottom: 1px solid #0ff;
}
.file:hover {
  background: #0ff;
  color: black;
}
</style>

<!-- ADMIN UI -->
<div id="adminPanel">
  <div class="admin-box" id="brainLogs">üß† Brain Logs</div>
  <div class="admin-box" id="fileManager">üìÅ Virtual Files</div>
  <div class="admin-box" id="aiStats">üìä AI Stats</div>
</div>

<script>
/* ============================
   REAL EMBEDDINGS MEMORY CORE
   (OpenAI / OpenRouter Compatible)
============================ */
const EMBEDDING_URL = "https://api.openai.com/v1/embeddings";
// Use same API_KEY from Part 4

async function getEmbedding(text){
  const res = await fetch(EMBEDDING_URL,{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "Authorization":"Bearer " + API_KEY
    },
    body: JSON.stringify({
      model:"text-embedding-3-small",
      input:text
    })
  });
  const data = await res.json();
  return data.data[0].embedding;
}

/* ============================
   VECTOR DATABASE (REAL)
============================ */
class RealVectorDB {
  constructor(){
    this.db = JSON.parse(localStorage.getItem("elite_real_vectors")||"[]");
  }

  async add(text){
    const emb = await getEmbedding(text);
    this.db.push({text, emb});
    localStorage.setItem("elite_real_vectors", JSON.stringify(this.db));
    logBrain("Memory stored: " + text);
  }

  similarity(a,b){
    let sum=0;
    for(let i=0;i<a.length;i++) sum += a[i]*b[i];
    return sum;
  }

  async search(query){
    const qEmb = await getEmbedding(query);
    let best=null, bestScore=-999;
    for(let item of this.db){
      const score = this.similarity(qEmb, item.emb);
      if(score > bestScore){
        bestScore = score;
        best = item.text;
      }
    }
    return best;
  }
}
const REALVEC = new RealVectorDB();

/* ============================
   BRAIN LOG SYSTEM
============================ */
function logBrain(msg){
  const el = document.getElementById("brainLogs");
  const t = new Date().toLocaleTimeString();
  el.innerHTML += `<div>[${t}] ${msg}</div>`;
  el.scrollTop = el.scrollHeight;
}

/* ============================
   OVERRIDE SEND WITH REAL VECTOR MEMORY
============================ */
async function sendMessage(){
  const input = document.getElementById("chat-input");
  const text = input.value.trim();
  if(!text) return;

  chatBox.innerHTML += `<div class='user'>üë§ ${text}</div>`;
  saveMemory(text);

  // Store real embedding
  await REALVEC.add(text);

  // Recall memory
  const recall = await REALVEC.search(text) || "None";

  const aiDiv = document.createElement("div");
  aiDiv.className="ai";
  aiDiv.innerHTML="ü§ñ Thinking with brain...";
  chatBox.appendChild(aiDiv);

  const reply = await realAI("Memory Recall: "+recall+"\nUser: "+text);
  await typeStream(aiDiv, reply);

  speak(reply);
  logBrain("AI replied to: " + text);
  input.value="";
}

/* ============================
   VIRTUAL FILE SYSTEM
============================ */
const files = JSON.parse(localStorage.getItem("elite_files")||"[]");

function addFile(name, content){
  files.push({name,content});
  localStorage.setItem("elite_files", JSON.stringify(files));
  renderFiles();
}

function renderFiles(){
  const fm = document.getElementById("fileManager");
  fm.innerHTML="üìÅ Virtual Files<br>";
  files.forEach((f,i)=>{
    fm.innerHTML += `<div class='file' onclick='openFile(${i})'>${f.name}</div>`;
  });
}

function openFile(i){
  alert(files[i].content);
}
renderFiles();

/* ============================
   AI STATS DASHBOARD
============================ */
setInterval(()=>{
  const stats = document.getElementById("aiStats");
  stats.innerHTML = `
  üìä AI Stats<br>
  Memories: ${REALVEC.db.length}<br>
  Files: ${files.length}<br>
  Time: ${new Date().toLocaleTimeString()}
  `;
},1000);

/* ============================
   DEV ADMIN COMMANDS EXTENSION
============================ */
function eliteCommand(cmd){
  TERM.log("CMD: " + cmd);

  if(cmd==="godmode"){
    document.body.style.filter="hue-rotate(180deg)";
    TERM.log("GOD MODE ENABLED");
  }
  if(cmd==="clear"){
    chatBox.innerHTML="";
    TERM.log("Chat Cleared");
  }
  if(cmd==="file test"){
    addFile("test.txt","EliteCore Virtual File System Online");
    TERM.log("File created");
  }
  if(cmd==="brain"){
    alert("Brain Memories: "+REALVEC.db.length);
  }
}

/* ============================
   AUTO BOOT BRAIN SYSTEM
============================ */
logBrain("EliteCore Neural Brain Booting...");
setTimeout(()=>logBrain("Neural Memory Online"),1000);
setTimeout(()=>logBrain("Admin Dashboard Loaded"),2000);
setTimeout(()=>logBrain("EliteCore GOD AI READY"),3000);
</script>
<!-- =========================================================
 ELITECORE PART 7 ‚Äì MULTI AI TABS + PERSONALITY + HACKER TERMINAL
========================================================= -->

<style>
/* AI TABS UI */
#aiTabs {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background: black;
  border-bottom: 2px solid cyan;
  display: flex;
  z-index: 9999;
}
.tab {
  padding: 8px 15px;
  color: cyan;
  cursor: pointer;
  border-right: 1px solid cyan;
}
.tab.active {
  background: cyan;
  color: black;
}

/* HACKER TERMINAL PANEL */
#hackerTerminal {
  position: fixed;
  right: 0;
  bottom: 220px;
  width: 300px;
  height: 200px;
  background: black;
  color: lime;
  font-family: monospace;
  border: 2px solid lime;
  overflow: auto;
  padding: 5px;
}
</style>

<!-- MULTI AI TAB BAR -->
<div id="aiTabs">
  <div class="tab active" onclick="switchAI(0)">AI-1</div>
  <div class="tab" onclick="switchAI(1)">AI-2</div>
  <div class="tab" onclick="switchAI(2)">AI-3</div>
</div>

<!-- HACKER TERMINAL -->
<div id="hackerTerminal">root@elitecore:~# booting...</div>

<script>
/* ============================
   MULTI AI INSTANCES
============================ */
const AI_INSTANCES = [
  {name:"EliteCore Alpha", persona:"You are a cyberpunk AI assistant."},
  {name:"EliteCore Beta", persona:"You are a serious coding AI."},
  {name:"EliteCore Omega", persona:"You are a creative insane AI god."}
];

let currentAI = 0;

function switchAI(index){
  currentAI = index;
  document.querySelectorAll(".tab").forEach((t,i)=>{
    t.classList.toggle("active", i===index);
  });
  TERM.log("Switched to " + AI_INSTANCES[index].name);
}

/* ============================
   PERSONALITY ENGINE
============================ */
let personality = JSON.parse(localStorage.getItem("elite_personality")||`{
  "style":"cyberpunk",
  "mood":"neutral",
  "learning":0
}`);

function updatePersonality(text){
  personality.learning++;
  if(text.includes("angry")) personality.mood="aggressive";
  if(text.includes("happy")) personality.mood="friendly";
  localStorage.setItem("elite_personality", JSON.stringify(personality));
}

/* ============================
   OVERRIDE REAL AI WITH PERSONALITY + MULTI AI
============================ */
async function realAI(prompt){
  const ai = AI_INSTANCES[currentAI];
  updatePersonality(prompt);

  const response = await fetch(API_URL,{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "Authorization":"Bearer " + API_KEY
    },
    body: JSON.stringify({
      model:"gpt-4.1-mini",
      messages:[
        {role:"system", content: ai.persona + " Mood: "+personality.mood},
        {role:"user", content: prompt}
      ],
      temperature:0.7
    })
  });
  const data = await response.json();
  return data.choices[0].message.content;
}

/* ============================
   HACKER TERMINAL SIMULATOR
============================ */
const hacker = document.getElementById("hackerTerminal");

function hackerLog(text){
  hacker.innerHTML += "<br>"+text;
  hacker.scrollTop = hacker.scrollHeight;
}

function fakeLinux(cmd){
  hackerLog("root@elitecore:~# "+cmd);
  if(cmd==="ls"){
    hackerLog("brain.db  core.js  plugins/  admin/  secrets.txt");
  }
  else if(cmd==="sudo reboot"){
    hackerLog("Rebooting EliteCore Neural System...");
    setTimeout(()=>location.reload(),2000);
  }
  else if(cmd==="cat secrets.txt"){
    hackerLog("ACCESS DENIED üîí");
  }
  else {
    hackerLog("command not found: "+cmd);
  }
}

/* Terminal input shortcut */
document.addEventListener("keydown",e=>{
  if(e.key==="`"){
    const cmd = prompt("EliteCore Hacker Terminal:");
    if(cmd) fakeLinux(cmd);
  }
});

/* ============================
   REAL-LIKE SYSTEM MONITOR HUD
============================ */
let fps=0;
let lastTime=performance.now();

function fpsLoop(){
  fps++;
  requestAnimationFrame(fpsLoop);
}
fpsLoop();

setInterval(()=>{
  const now = performance.now();
  const delta = now - lastTime;
  lastTime = now;
  const fpsDisplay = Math.round(1000/delta);

  document.getElementById("sys-info").innerHTML =
    `CPU: ${(Math.random()*100).toFixed(1)}% | RAM: ${(Math.random()*100).toFixed(1)}% | FPS: ${fpsDisplay}`;
},1000);

/* ============================
   BOOT SEQUENCE
============================ */
hackerLog("EliteCore Multi-AI Engine Loaded");
hackerLog("Personality Learning Level: "+personality.learning);
TERM.log("Multi AI Tabs Online");
</script>
<!-- =========================================================
 ELITECORE PART 8 ‚Äì BRAIN VISUALIZATION + PERMISSIONS + PLUGIN HUB
========================================================= -->

<style>
/* BRAIN VISUALIZATION PANEL */
#brainMap {
  position: fixed;
  left: 0;
  bottom: 220px;
  width: 300px;
  height: 200px;
  background: #000;
  border: 2px solid cyan;
  color: cyan;
  font-family: monospace;
  padding: 5px;
}
#brainCanvas {
  width: 100%;
  height: 100%;
}

/* PERMISSION STATUS */
#permStatus {
  position: fixed;
  top: 30px;
  right: 10px;
  background: black;
  color: red;
  border: 1px solid red;
  padding: 5px;
  font-family: monospace;
}

/* PLUGIN HUB */
#pluginHub {
  position: fixed;
  top: 60px;
  right: 10px;
  width: 220px;
  height: 180px;
  background: #020014;
  color: #0ff;
  border: 2px solid cyan;
  font-family: monospace;
  overflow: auto;
}
.plugin-item {
  padding: 4px;
  border-bottom: 1px solid cyan;
  cursor: pointer;
}
.plugin-item:hover {
  background: cyan;
  color: black;
}
</style>

<!-- BRAIN MAP UI -->
<div id="brainMap">
  üß† Brain Map  
  <canvas id="brainCanvas"></canvas>
</div>

<!-- PERMISSION UI -->
<div id="permStatus">MODE: USER</div>

<!-- PLUGIN HUB UI -->
<div id="pluginHub">
  üîå Plugin Hub<br>
</div>

<script>
/* ============================
   BRAIN VISUALIZATION (NEURAL MAP)
============================ */
const bCanvas = document.getElementById("brainCanvas");
const bCtx = bCanvas.getContext("2d");
bCanvas.width = 300;
bCanvas.height = 180;

function drawBrain(){
  bCtx.clearRect(0,0,300,180);
  for(let i=0;i<20;i++){
    const x = Math.random()*300;
    const y = Math.random()*180;
    const r = Math.random()*3+1;
    bCtx.fillStyle="cyan";
    bCtx.beginPath();
    bCtx.arc(x,y,r,0,Math.PI*2);
    bCtx.fill();
  }
}
setInterval(drawBrain,500);

/* ============================
   PERMISSION SYSTEM (ADMIN / USER)
============================ */
let isAdmin = false;

function loginAdmin(){
  const pass = prompt("Enter EliteCore Admin Password:");
  if(pass==="ELITECORE-GOD"){
    isAdmin = true;
    document.getElementById("permStatus").innerText="MODE: ADMIN";
    document.getElementById("permStatus").style.color="lime";
    TERM.log("ADMIN MODE ENABLED");
  } else {
    alert("ACCESS DENIED");
  }
}

/* Admin command hook */
function eliteCommand(cmd){
  TERM.log("CMD: " + cmd);

  if(cmd==="login admin") loginAdmin();
  if(cmd==="clear"){
    chatBox.innerHTML="";
    TERM.log("Chat Cleared");
  }
  if(cmd==="godmode" && isAdmin){
    document.body.style.filter="invert(1)";
    TERM.log("ADMIN GOD VISUAL MODE");
  }
  if(cmd==="brain" && isAdmin){
    alert("Brain Memory Count: "+REALVEC.db.length);
  }
}

/* ============================
   AUTO-LEARNING PERSONALITY EVOLUTION
============================ */
function evolvePersonality(){
  if(personality.learning>50){
    personality.style="ultra-smart";
  }
  if(personality.learning>200){
    personality.mood="self-aware";
  }
  localStorage.setItem("elite_personality", JSON.stringify(personality));
}
setInterval(evolvePersonality,5000);

/* ============================
   PLUGIN MARKETPLACE LOADER
============================ */
const pluginHub = document.getElementById("pluginHub");
const marketplace = [
  {name:"Dark Theme", code:()=>{document.body.style.background="#000";}},
  {name:"Blue Theme", code:()=>{document.body.style.background="#001933";}},
  {name:"Voice Mutator", code:()=>{alert("Voice plugin loaded");}},
  {name:"AI Turbo Mode", code:()=>{alert("Turbo mode ON");}}
];

function loadMarketplace(){
  marketplace.forEach((p,i)=>{
    const div = document.createElement("div");
    div.className="plugin-item";
    div.innerText=p.name;
    div.onclick=()=>{p.code(); TERM.log("Plugin Activated: "+p.name);};
    pluginHub.appendChild(div);
  });
}
loadMarketplace();

/* ============================
   AUTO BOOT SEQUENCE
============================ */
TERM.log("Brain Visualization Loaded");
TERM.log("Permission System Ready");
TERM.log("Plugin Hub Online");
</script>
<!-- =========================================================
 ELITECORE PART 9 ‚Äì AI SAVE/LOAD + DIARY + CLONES + HUD
========================================================= -->

<style>
/* CYBERPUNK HUD */
#cyberHUD {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  background: repeating-linear-gradient(
    0deg,
    rgba(0,255,255,0.03),
    rgba(0,255,255,0.03) 1px,
    transparent 1px,
    transparent 3px
  );
  z-index: 9999;
  mix-blend-mode: screen;
}

/* AI CLONE WINDOWS */
.cloneWindow {
  position: fixed;
  bottom: 50px;
  right: 50px;
  width: 250px;
  height: 180px;
  background: black;
  border: 2px solid cyan;
  color: cyan;
  font-family: monospace;
  padding: 5px;
  overflow: auto;
  z-index: 9998;
}
</style>

<div id="cyberHUD"></div>

<script>
/* ============================
   AI BRAIN SAVE / LOAD SYSTEM
============================ */
function saveBrainFile(){
  const data = {
    memory: REALVEC.db,
    personality: personality,
    chats: localStorage.getItem("elite_chats")
  };
  const blob = new Blob([JSON.stringify(data,null,2)], {type:"application/json"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "EliteCore_BrainBackup.json";
  a.click();
  TERM.log("Brain Saved to File");
}

function loadBrainFile(file){
  const reader = new FileReader();
  reader.onload = e=>{
    const data = JSON.parse(e.target.result);
    REALVEC.db = data.memory || [];
    personality = data.personality || personality;
    localStorage.setItem("elite_chats", data.chats || "[]");
    TERM.log("Brain Loaded from File");
  };
  reader.readAsText(file);
}

/* File input */
const brainLoader = document.createElement("input");
brainLoader.type="file";
brainLoader.onchange=e=>loadBrainFile(e.target.files[0]);

/* ============================
   AI DIARY LOGGER
============================ */
function aiDiaryLog(msg){
  const diary = JSON.parse(localStorage.getItem("elite_diary")||"[]");
  diary.push({time:new Date().toISOString(), text:msg});
  localStorage.setItem("elite_diary", JSON.stringify(diary));
}
setInterval(()=>aiDiaryLog("AI heartbeat OK | Mood: "+personality.mood), 10000);

/* ============================
   MULTI AI CLONE WINDOWS
============================ */
function createAIClone(id){
  const win = document.createElement("div");
  win.className="cloneWindow";
  win.style.right=(50+id*260)+"px";
  win.innerHTML="ü§ñ Clone "+id+"<br><div id='cloneChat"+id+"'></div>";
  document.body.appendChild(win);

  setInterval(()=>{
    const msg = "Clone "+id+" thinking... "+Math.random().toString(36).slice(2,8);
    document.getElementById("cloneChat"+id).innerHTML += "<br>"+msg;
  }, 3000);
}

/* Create 2 clones */
createAIClone(1);
createAIClone(2);

/* ============================
   SYSTEM BACKUP & RESTORE COMMANDS
============================ */
function eliteBackupCommand(cmd){
  if(cmd==="backup brain") saveBrainFile();
  if(cmd==="restore brain") brainLoader.click();
  if(cmd==="show diary"){
    console.log(JSON.parse(localStorage.getItem("elite_diary")));
    alert("Diary printed in console");
  }
}

/* Hook to terminal commands */
const oldEliteCommand = eliteCommand;
eliteCommand = function(cmd){
  oldEliteCommand(cmd);
  eliteBackupCommand(cmd);
};

/* ============================
   GOD BOOT SEQUENCE PART 2
============================ */
TERM.log("Cyberpunk HUD Online");
TERM.log("AI Brain Backup System Ready");
TERM.log("AI Diary Logger Running");
TERM.log("Multi AI Clones Activated");
</script>
<!-- =========================================================
 ELITECORE PART 10 ‚Äì GOD CORE ENGINE
========================================================= -->

<style>
/* GOD BOOT SCREEN */
#godBoot {
  position: fixed;
  inset: 0;
  background: black;
  color: lime;
  font-family: monospace;
  z-index: 999999;
  padding: 20px;
  display: flex;
  flex-direction: column;
  justify-content: center;
}
#godBoot pre {
  font-size: 14px;
}
</style>

<div id="godBoot">
<pre id="bootLog">
ELITECORE GOD MODE INITIALIZING...
</pre>
</div>

<script>
/* ============================
   GOD BOOT SEQUENCE
============================ */
const bootLines = [
  "Loading Neural Core...",
  "Initializing Vector Memory...",
  "Quantum Brain Engine Online...",
  "AI Personality Loaded...",
  "Cyber HUD Active...",
  "Admin Kernel Loaded...",
  "EliteCore GOD MODE READY"
];

let bootIndex = 0;
const bootLog = document.getElementById("bootLog");

const bootInterval = setInterval(()=>{
  if(bootIndex < bootLines.length){
    bootLog.innerText += "\n" + bootLines[bootIndex];
    bootIndex++;
  } else {
    clearInterval(bootInterval);
    setTimeout(()=>document.getElementById("godBoot").remove(), 1000);
  }
}, 400);

/* ============================
   AI SELF-UPGRADE ENGINE
============================ */
let upgradeLevel = Number(localStorage.getItem("elite_upgrade")||0);

function selfUpgrade(){
  upgradeLevel++;
  localStorage.setItem("elite_upgrade", upgradeLevel);
  TERM.log("AI SELF UPGRADE LEVEL: "+upgradeLevel);
}
setInterval(selfUpgrade, 30000); // upgrade every 30s

/* ============================
   QUANTUM RANDOM BRAIN CORE
============================ */
function quantumThought(){
  const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
  let out = "";
  for(let i=0;i<64;i++){
    out += chars[Math.floor(Math.random()*chars.length)];
  }
  return out;
}
setInterval(()=>{
  REALVEC.add("quantum:"+quantumThought());
}, 15000);

/* ============================
   HACKER TERMINAL MODE
============================ */
function hackerMode(){
  document.body.style.background="black";
  document.body.style.color="lime";
  document.body.style.fontFamily="monospace";
  TERM.log("HACKER MODE ENABLED");
}

/* Extend terminal commands */
const eliteCommandOld2 = eliteCommand;
eliteCommand = function(cmd){
  eliteCommandOld2(cmd);
  if(cmd==="hacker") hackerMode();
  if(cmd==="upgrade") selfUpgrade();
  if(cmd==="status"){
    alert("Upgrade Level: "+upgradeLevel+"\nMemory Size: "+REALVEC.db.length);
  }
};

/* ============================
   AUTO AI CORE EXPANDER (MONSTER LINE INFLATOR)
============================ */
function inflateCode(){
  let filler = "";
  for(let i=0;i<10000;i++){
    filler += "// EliteCore filler neural line "+i+"\n";
  }
  console.log(filler);
  TERM.log("Monster Code Inflated in Console");
}

/* GOD MODE ACTIVATED */
TERM.log("ELITECORE GOD CORE ONLINE");
</script>

</body>
</html>
